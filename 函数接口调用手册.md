# 函数接口调用手册

手册按照首字母排列

请仔细阅读调用手册

⚠️***注意保持手册为最新版本***

⚠️**标有此符号的函数请注意使用细节**

当前版本：8.5：已合并singer和user。未完成hqr写的recentsong中的合并

尚未做二级评论等

比以前版本还额外修改了：

allMessage系列函数参数to改为userId

rankOfSongListIdAndUserId改为Get方法



> [!NOTE]
>
> 以下大多**非查询类**函数返回值为jsonObject。若为此返回值时，通常code代表返回码，msg为返回信息

# /collect-收藏

**主地址**：/collect

### /add

用途：添加新收藏

类型：Post

参数：userId 用户Id；type 类型（0为歌曲，1为歌单）；songId 歌曲Id；songListId 歌单Id

### /deleteCollectSong

用途：删除收藏歌曲

类型：Get

参数：userId 用户Id；songId 歌曲Id

### /deleteCollectSongList

用途：删除收藏歌单

类型：Get

参数：userId 用户Id；songListId 歌单Id

### /allCollect

用途：获取全部收藏（包含歌曲和歌单）

类型：Get

参数：无

返回值：List<Collect>

### /collectOfUserId

用途：获取指定用户的全部收藏（包含歌曲和歌单）

类型：Get

参数：userId

返回值：List<Collect>

### /collectSongOfUserId

用途：获取指定用户的全部**歌曲**收藏

类型：Get

参数：userId

返回值：List<Collect>

### /collectSongListOfUserId

用途：获取指定用户的全部**歌单**收藏

类型：Get

参数：userId

返回值：List<Collect>

### /songCollectNum

用途：获取指定**歌曲**的总收藏量

类型：Get

参数：songId

返回值：Integer

### /songListCollectNum

用途：获取指定**歌单**的总收藏量

类型：Get

参数：songId

返回值：Integer

### /existCollectSong

用途：判断指定**歌曲**是否被指定**用户**收藏

类型：Get

参数：userId、songId

返回值：boolean

### /existCollectSongList

用途：判断指定**歌单**是否被指定**用户**收藏

类型：Get

参数：userId、songListId

返回值：boolean

# /comment-评论

### /add

用途：添加新评论

类型：Post

参数：userId 用户Id；type 类型（0为歌曲，1为歌单）；songId 歌曲Id；songListId 歌单Id；content 内容

### /update

用途：更改指定id的评论（应该用不上）

类型：Post

参数：id 评论的id；userId 用户Id；type 类型（0为歌曲，1为歌单）；songId 歌曲Id；songListId 歌单Id；content 内容

### /delete

用途：删除id对应评论

类型：Get

参数：id 评论的id

### /selectByPrimaryKey

用途：根据id得到对应评论

类型：Get

参数：id

### /allComment

用途：获取全部评论

类型：Get

### /commentOfSongId

用途：获取songId对应的全部评论

类型：Get

参数：songId

### /commentOfSongListId

用途：获取songListId对应的全部评论

类型：Get

参数：songListId

# /complaint-投诉

### /add

用途：添加新投诉

类型：Post

参数：userId 用户Id；type 类型（0为歌曲，1为歌单）；songId 歌曲Id；songListId 歌单Id；content 内容

### /update

用途：更改指定id的投诉

类型：Post

参数：id 投诉的id；userId 用户Id；type 类型（0为歌曲，1为歌单）；songId 歌曲Id；songListId 歌单Id；content 内容

### /delete

用途：删除id对应投诉

类型：Get

参数：id 投诉的id

### /selectByPrimaryKey

用途：根据id得到对应投诉

类型：Get

参数：id

### /allComment

用途：获取全部投诉

类型：Get

### /ignore

用途：忽略id对应投诉（先删除投诉，随后向用户发信息表示歌曲没问题）

⚠️注意：此接口一般用于管理员功能

类型：Get

参数：id 投诉的id

### /allComplaintByUser

用途：得到对应用户**发起**的所有投诉

类型：Get

参数：userId

### /allComplaintAgainstUser

用途：得到对应用户**受到**的所有投诉

类型：Get

参数：userId

### /appealComplaint

用途：对id对应投诉发起**申诉**

类型：Post

参数：id（投诉id）、appeal（申诉内容）

# /follow-关注

------

⚠️**请注意：所有singerId都采用user表中的Id！只是为了区分关注者（user）和被关注者（singer），在此处使用别名**

------

### /add

用途：添加新关注

类型：Post

参数：userId 用户Id；singerId（**被**关注者对应的**用户Id**）

### /delete

用途：取消id对应关注

类型：Get

参数：id 关注的id

### /deleteByUserIdAndSingerId

用途：取消“用户-被关注者”对应关注

类型：Get

参数：userId 用户Id；singerId（**被**关注者对应的**用户Id**）

### /selectByPrimaryKey

用途：根据id得到对应关注

类型：Get

参数：id

### /selectByUserIdAndSingerId

用途：根据“用户-被关注者”得到对应关注

类型：Get

参数：userId 用户Id；singerId（**被**关注者对应的**用户Id**）

### /existFollow

用途：根据“用户-被关注者” 判断是否有此关注关系

类型：Get

参数：userId 用户Id；singerId（**被**关注者对应的**用户Id**）

<u>**返回值：Boolean**</u>

### /getByUserId

用途：根据用户id得到 该用户关注别人的信息

⚠️**注意：请注意返回值是Follow的列表，不是User的列表**

类型：Get

参数：userId 用户Id

返回值：List<Follow>

### /getBySingerId

用途：根据**被关注者**id得到 该用户被别人关注的信息

⚠️**注意：请注意返回值是Follow的列表，不是User的列表**

类型：Get

参数：singerId 被关注用户的Id

返回值：List<Follow>

### /getCountByUserId

用途：根据用户id得到 该用户关注别人的数量

类型：Get

参数：userId 用户Id

返回值：Integer

### /getCountBySingerId

用途：根据**被关注者**用户id得到 该用户被别人关注的数量

类型：Get

参数：singerId 被关注用户的Id

返回值：Integer

# /listSong-歌单中歌曲

### /add

用途：给歌单中添加新歌曲

类型：Post

参数：songId歌曲Id；songListId歌单Id

### /delete

用途：删除对应歌单中的 对应歌曲

类型：Get

参数：songId歌曲Id；songListId歌单Id

### /detail

用途：得到对应歌单中的全部歌曲

⚠️**注意：请注意返回值**

类型：Get

参数：songListId歌单Id

返回值：List<ListSong>

### /allSong

用途：得到对应歌单中的全部歌曲

⚠️**注意：请注意返回值**

类型：Get

参数：songListId歌单Id

返回值：List<Song>

# /mail-邮件

### /sendMail

用途：向对应邮箱发送包含验证码的邮件，并返回验证码

类型：Get

参数：to（邮箱地址）

返回值：jsonObject ：其中verifyCode代表验证码（res.verifyCode）

# /message-信息

### /add

用途：发送新消息

类型：Post

参数：to 发向用户的id ；text 文本；type类型（目前只有0）；from（-1为系统，其余为用户id）

### /read

用途：让消息变成已读状态

类型：Post

参数：id 消息id

### /delete

用途：删除消息

类型：Get

参数：id 消息id

### /deleteAllReadMessage

用途：删除某用户底下的所有已读消息

类型：Get

参数：userId 用户Id

### /allMessage

用途：获取用户的全部消息

类型：Get

参数：userId 用户Id

### /allMessageUnread

用途：获取用户的全部**未读**消息

类型：Get

参数：userId 用户Id

### /allMessageRead

用途：获取用户的全部**已读**消息

类型：Get

参数：userId 用户Id

### /messageUnreadNum

用途：获取用户的全部**未读**消息**数量**

类型：Get

参数：userId 用户Id

返回值：Integer

# /rank-评分

### /add

用途：添加新评分

类型：Post

参数：userId 用户Id；songListId 歌单id；score 分数

### /rankOfSongListIdAndUserId

用途：查询 对应用户给对应歌单的评分

类型：Get

参数：userId 用户Id；songListId 歌单Id

### /rankOfSongListId

用途：查询 歌单评分

类型：Get

参数：songListId 歌单Id



# /song-歌曲

### /add

用途：添加新歌曲，并自动发送信息给所有关注你的人信息

类型：Post

参数：userId 用户Id；name歌曲名字；introduction歌曲简介；lyric歌词；style 风格

### /update

用途：更新歌曲

类型：Post

参数：userId 用户Id；name歌曲名字；introduction歌曲简介；lyric歌词；style 风格

### /delete

用途：删除id对应歌曲

类型：Get

参数：id 歌曲的id

### /invisible

用途：让id对应歌曲 **不可见（下架）**，会自动发送歌曲下架消息给用户

*一般是管理员用的

类型：Get

参数：id 歌曲的id

### /visible

用途：让id对应歌曲 **可见（恢复）**，会自动发送歌曲恢复消息给用户

*一般是管理员用的

类型：Get

参数：id 歌曲的id

### /updateSongPic

用途：更新歌曲封面

类型：Post

参数：file（MultipartFile avatorFile类型的文件）；id歌曲id

### /updateSongUrl

用途：更新歌曲音频文件

类型：Post

参数：file（MultipartFile avatorFile类型的文件）；id歌曲id

### /addNums

用途：给歌曲播放次数+1

⚠️注意：每次播放歌曲后都应使用此函数

类型：Get

参数：songId 歌曲id

### /isSongOfUser

用途：判断歌曲是不是该用户的

类型：Get

参数：songId 歌曲id；userId用户id

返回值：boolean

------

> [!IMPORTANT]
>
> 以下所有函数获得的歌曲名字均为原名。
>
> 如果想要获得《歌手-歌曲名》形式的名称，可以在原有地址上添加
>
> **`/addPrefix`**进行调用
>
> 如：`/detail/addPrefix`

### /detail

用途：根据歌曲id查询歌曲对象

类型：Get

参数：songId 歌曲id

### /allInvisible

用途：获取全部不可见歌曲

类型：Get

### /allSong

用途：获取全部歌曲

类型：Get

### /topSong

用途：按播放次数排列，获取全部歌曲

类型：Get

### /songOfUserId

用途：获取用户所有歌曲

类型：Get

参数：userId

### /songOfSongName

用途：精确查找名字对应的歌曲

类型：Get

参数：songName

### /likeSongOfName

用途：模糊查找名字对应的歌曲

类型：Get

参数：songName

### /songOfStyle

用途：获取风格对应歌曲

类型：Get

参数：style

### /popularSongOfUser

用途：获取某用户被**点赞**最多的歌

类型：Get

参数：userId

### /popularCollectedSongOfUser

用途：获取某用户被**收藏**最多的歌

类型：Get

参数：userId

# /songList-歌单

### /add

用途：添加新歌单

类型：Post

参数：userId 用户Id；title歌单名字；introduction简介；style 风格

### /update

用途：更新歌单

类型：Post

参数：userId 用户Id；title歌单名字；introduction简介；style 风格

### /delete

用途：删除id对应歌单

类型：Get

参数：id 歌单的id

### /selectByPrimaryKey

用途：得到id对应歌单

类型：Get

参数：id 歌单的id

### /selectByUserId

用途：得到用户全部歌单

类型：Get

参数：id 用户的id

返回：List<SongList>

### /allSongList

用途：得到全部歌单

类型：Get

返回：List<SongList>

### /songListOfTitle

用途：**精确**名字对应全部歌单

类型：Get

参数：title 歌单名

返回：List<SongList>

### /likeTitle

用途：**模糊**名字对应全部歌单

类型：Get

参数：title 歌单名

返回：List<SongList>

### /likeStyle

用途：**模糊**风格对应全部歌单

类型：Get

参数：style 风格

返回：List<SongList>

### /updateSongListPic

用途：更新封面

类型：Post

参数：file（MultipartFile avatorFile类型的文件）；id歌单id

### /bestSongListOfUser

用途：得到用户评分最高歌单。如果没人给他评分，返回其第一个歌单。若没歌单返回空。

类型：Get

参数：userId 用户的id

返回：SongList

------

**下面部分为管理员函数**

### /invisible

用途：让歌单**下架**，发信息给用户

类型：Get

参数：id 歌单的id

### /visible

用途：让歌单**上架恢复**，发信息给用户

类型：Get

参数：id 歌单的id

### /allInvisibleSongList

用途：所有下架歌单

类型：Get

# /user-用户

### /add

用途：添加新用户

类型：Post

参数：username用户名；password密码；**name昵称**；sex性别；email邮箱；birth生日；introduction简介；location国籍

### /update

用途：更新用户

类型：Post

参数：id用户id；username用户名；password密码；**name昵称**；sex性别；email邮箱；birth生日；introduction简介；location国籍

### /delete

用途：删除用户

类型：Get

参数：id 用户id。

### /selectByPrimaryKey

用途：得到id对应用户

类型：Get

参数：id

### /getByUsername

用途：得到用户名全部歌单

⚠️**注意：不是昵称**

类型：Get

参数：username

### /allUser

用途：得到全部用户

类型：Get

### /getOneUserWithName

用途：精确昵称对应用户

类型：Get

参数：name

### /getUserWithName

用途：模糊昵称对应用户 （可能用不到，因为目前不允许重复昵称）

类型：Get

参数：name

### /getUserWithSex

用途：该性别对应的**全部用户**

类型：Get

参数：sex

### /updateUserPic

用途：更新头像

类型：Post

参数：file（MultipartFile avatorFile类型的文件）；id歌单id

### /login

用途：登录，自动保存cookie

类型：Post

参数：username用户名；password密码

返回code为1代表成功登录，成功时还会有username、userId、avator一并存在jsonObject中

### /logout

用途：登出，**删除cookie**

类型：Post

### /preLogin

用途：根据cookie，判断是否能自动登录。

类型：Post

返回值：jsonObject，其中code为1代表登陆成功。成功时还会有username、userId、avator一并存在jsonObject中